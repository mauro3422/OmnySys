# CHANGELOG - OmnySys

## [0.2.0] - 2026-02-01

### Added - Phase 2: Function-Level Tracking (COMPLETE ✓)

#### Core Features
- **Function Extraction**: parser.js now extracts individual functions with metadata
  - Function ID: `FILEID:functionName` format (e.g., `FI:functionA`)
  - Metadata tracked: name, line number, endLine, parameters, isExported flag
  - Call tracking: Detects all direct function calls within each function with line numbers

- **Function Linking**: graph-builder.js creates bidirectional function call graph
  - `function_links` array: Tracks function-to-function calls across files
  - Format: `{ from, to, type, line, file_from, file_to }`
  - Cross-file call resolution using import tracking

- **Enhanced Metadata**:
  - Added `totalFunctions` counter
  - Added `totalFunctionLinks` counter

#### Implementation Details
- **parser.js changes** (288 → 350 lines):
  - Added `functions` array to FileInfo output
  - New helper: `findCallsInFunction()` - traverses function body for CallExpressions
  - New helper: `isExportedFunction()` - checks if function appears in exports
  - New helper: `getFileId()` - generates unique file prefix for IDs

- **graph-builder.js changes** (334 → 410 lines):
  - New `functions` key in systemMap (maps file → functions array)
  - New `function_links` array (all function-to-function calls)
  - New helper: `findFunctionInResolution()` - resolves function calls across import boundaries
  - New helper: `countTotalFunctions()` - calculates total function count

#### Test Results
- **scenario-1-simple-import validation**: ✓ PASS
  - Extracted functions: 5 (functionA, displayConstant, functionB, getConstant, functionC)
  - Function links detected: 3
  - Cross-file resolution: ✓ All calls correctly matched
  - Line numbers: ✓ Accurate (file A calls file B at line 9, etc.)

#### Output Example
```json
{
  "functions": {
    "src/fileA.js": [
      {
        "id": "FI:functionA",
        "name": "functionA",
        "line": 8,
        "endLine": 11,
        "params": ["value"],
        "isExported": true,
        "calls": [
          { "name": "functionB", "type": "direct_call", "line": 9 }
        ]
      }
    ]
  },
  "function_links": [
    {
      "from": "FI:functionA",
      "to": "FI:functionB",
      "type": "call",
      "line": 9,
      "file_from": "src/fileA.js",
      "file_to": "src/fileB.js"
    }
  ]
}
```

#### Backward Compatibility
- ✓ File-level graph still intact
- ✓ All existing metadata preserved
- ✓ Dependencies array unchanged
- ✓ Purely additive: function tracking is new feature layer

#### Next Steps
- **Phase 2.5**: AI Editor Integration using function-level graph
  - Query: "What functions depend on this?"
  - Query: "What's the impact of editing this function?"
  - Utilize function_links for impact analysis