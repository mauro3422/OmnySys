# v0.9.43 - Mixin & Namespace Import calledBy Detection

## Problema resuelto

El extractor de `calledBy` tenía un punto ciego crítico: **no resolvía llamadas
via namespace imports ni via patrones mixin (Object.assign)**. Esto dejaba funciones
enteras como "huérfanas" aunque fueran ampliamente usadas.

## Patrones que ahora se detectan

### Patrón 1 — Namespace import call

```js
import * as utils from './utils.js'
utils.doSomething()   // ← doSomething en utils.js ahora recibe calledBy ✅
```

Antes: `doSomething.calledBy = []` (invisible)
Ahora: `doSomething.calledBy = ['archivo-que-la-llama.js::caller']`

### Patrón 2 — Object.assign mixin (prototype delegation)

```js
import * as handlers from './handlers.js'
Object.assign(FileWatcher.prototype, handlers)

// En otro archivo:
this.handleFileModified()  // ← handleFileModified en handlers.js ahora recibe calledBy ✅
```

Este es el patrón exacto que usaba `file-watcher/index.js`. Todas las funciones
de `handlers.js`, `lifecycle.js`, `analyze.js` estaban con calledBy=0.

## Caso concreto que motivó el fix (auditoría)

Al auditar el sistema con sus propias herramientas MCP:
- `get_call_graph(handlers.js, handleFileModified)` → "orphan, 0 call sites"
- `explain_connection(handlers.js, lifecycle.js)` → "not connected"
- `get_molecule_summary(handlers.js)` → `calledBy: 0` en TODO

Todo falso. La conexión real:
```
index.js: import * as handlers + Object.assign(FileWatcher.prototype, handlers)
lifecycle.js: this.handleFileModified()  → handlers.js::handleFileModified
```

## Nuevo archivo

### `src/layer-a-static/pipeline/phases/calledby/mixin-namespace-linker.js`

Cuarto linker del sistema calledBy. Algoritmo en 4 fases:

1. **buildNamespaceMap**: extrae `import * as alias from './path'` por archivo
2. **detectMixins**: detecta `Object.assign(target, alias)` para mapear qué archivos
   se mezclan en `this` de qué clases
3. **Linking Patrón 1**: para cada call `alias.method()`, resuelve alias → filePath →
   atom en ese archivo → agrega calledBy
4. **Linking Patrón 2**: para cada call `this.method()`, busca en los archivos mezclados
   si alguno exporta `method` → agrega calledBy

## Registro en indexer

```
3.6a: linkFunctionCalledBy        (llamadas directas)
3.6b: linkVariableCalledBy        (referencias a variables exportadas)
3.6c: linkMixinNamespaceCalledBy  (namespace imports + mixin this.*) ← NUEVO
3.7:  resolveClassInstantiationCalledBy (new ClassName() → obj.method())
```

## Impacto esperado

Todos los archivos que usen el patrón `import * as X` / `Object.assign` ahora
tendrán calledBy correcto. Esto desbloquea:
- `get_call_graph` con resultados reales
- `explain_connection` detectando conexiones via mixin
- `get_impact_map.directlyAffects` con propagación real
- `get_molecule_summary.calledBy` con conteos correctos
