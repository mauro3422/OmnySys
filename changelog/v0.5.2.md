# Changelog v0.5.2 - Documentation Overhaul, Rename & New Extractors

**Fecha**: 2026-02-06

## Overview

Release mayor con tres ejes: limpieza total de documentacion, rename del proyecto a OmnySys, y nuevos extractores/arquetipos con optimizacion del LLM Gate.

---

## Cambios Principales

### 1. Rename del Proyecto

- CogniSystem / OmnySystem → **OmnySys** (nombre oficial)
- `.OmnySysData` / `.OmnySystemData` → **`.omnysysdata`** (carpeta de datos)
- Actualizado en ~30+ archivos (docs, codigo fuente, test cases, CLI)
- Constante `DATA_DIR` en `storage-manager.js` actualizada
- Scanner ignore list actualizada
- CLI help y output strings actualizados

### 2. Limpieza de Documentacion

**15 archivos eliminados:**

Root (9):
- `session-ses_3d48.md` — Dump de sesion de IA (53k tokens)
- `CHECKPOINT-2026-02-05.md` — Snapshot temporal obsoleto
- `DEBUG_STATUS.md` — Issue resuelto
- `PHASE-2-PLAN.md` — Plan completado
- `PLAN-DATA-PERSISTENCE.md` — Plan completado (v0.4.x)
- `PLAN-LLM-OPTIMIZATION.md` — Plan implementado
- `PROBLEMATICAS.md` — Issues resueltos
- `ideafuturo.md` — Contenido movido a FUTURE_IDEAS.md
- `MCP-GUIDE.md` — Contenido absorbido por docs/MCP_TOOLS.md

docs/ (6):
- `METADATA_PROMPT_STANDARD.md` — Deprecated, reemplazado por metadata-prompt-system.md
- `creating-new-prompt-template.md` — Unificado en ARCHETYPE_DEVELOPMENT_GUIDE.md
- `SYSTEM_STATUS_ANALYSIS.md` — Historico, superseded
- `LFM2_EXTRACT_GUIDE.md` — Consolidado en AI_MODELS_GUIDE.md
- `LFM2_EXTRACT_PROMPTING_GUIDE.md` — Consolidado en AI_MODELS_GUIDE.md
- `LFM2_OPTIMIZATION.md` — Consolidado en AI_MODELS_GUIDE.md

**4 archivos reescritos:**
- `README.md` (370 → 98 lineas) — Sin duplicacion, metafora de la caja con cables
- `ARCHITECTURE.md` (919 → 285 lineas) — Diagramas esenciales, cross-refs a docs especializados
- `GETTING_STARTED.md` (336 → 126 lineas) — Solo install/run/use/troubleshoot
- `docs/INDEX.md` (250 → 116 lineas) — Indice limpio por categoria

**1 archivo nuevo:**
- `docs/AI_MODELS_GUIDE.md` — Consolidacion de 3 guias LFM2

**3 archivos enriquecidos:**
- `docs/MCP_TOOLS.md` — De skeleton (27 lineas) a doc completo (196 lineas) con CLI, flow, troubleshooting
- `docs/FUTURE_IDEAS.md` — Agregada idea de Semantic Pattern Engine (de ideafuturo.md)
- `docs/DOCUMENTATION_GUIDE.md` — Actualizada estructura de archivos

### 3. Arquetipos: Cleanup + Arquitectura LLM

**Arquetipos removidos:**
- `styled-component` — No describe conexiones entre archivos
- `type-definer` — No describe conexiones entre archivos

**Archivos removidos:**
- `prompt-templates/css-in-js.js`, `prompt-templates/typescript.js`
- `json-schemas/css-in-js.json`, `json-schemas/typescript.json`

**Documentacion de arquitectura LLM:**
- Documentado "Test de la Caja" para validar arquetipos
- Documentada regla "confidence 1.0 = NO gastar LLM"
- Documentados Tres Gates de decision de LLM con bypass
- Analisis honesto por arquetipo: cuales siempre necesitan LLM vs cuales pueden hacer bypass
- Actualizado en: ARCHETYPE_SYSTEM.md, ARCHITECTURE_LAYER_A_B.md, metadata-prompt-system.md

### 4. Nuevos Extractores (Layer A)

**Shared Route Extractor** (`route-extractor.js` + `route-connections.js`):
- Detecta rutas API compartidas entre archivos
- `app.get("/api/users")` ↔ `fetch("/api/users")` → conexion `shared-route`, confidence 1.0
- Soporta Express, Koa, Fastify, fetch, axios

**Environment Variable Coupling** (`env-connections.js`):
- Cruza `process.env.*` entre archivos
- Dos archivos que leen `process.env.DB_HOST` → conexion `shared-env`, confidence 1.0

**Co-located File Groups** (`colocation-extractor.js`):
- Detecta archivos hermanos por naming convention
- `Button.js` + `Button.test.js` → conexion `colocated`, tipo `test-companion`
- Soporta: .test, .spec, .stories, .module.css, .mock, .fixture, __tests__/

### 5. Nuevos Arquetipos (3)

| Arquetipo | Severity | Que detecta |
|-----------|----------|-------------|
| `facade` | 4 | Re-exporta de multiples modulos (index.js) |
| `config-hub` | 5 | Exporta config consumida por muchos (radioactivo) |
| `entry-point` | 3 | Inicio de ejecucion, importa mucho, nadie lo importa |

Cada uno con: detector, prompt template, response schema, validator.

### 6. Optimizacion LLM Gate

**Problema**: El sistema mandaba al LLM archivos cuyas conexiones ya estaban resueltas por Layer A con confidence 1.0.

**Solucion**: Nuevo Gate 2 (bypass check) en `analysis-decider.js`:
- Si el arquetipo es condicional (event-hub, global-state, state-manager, singleton) Y todas las conexiones ya estan cruzadas con confidence >= 1.0 → NO enviar a LLM
- Arquetipos que siempre necesitan LLM: god-object, dynamic-importer, orphan-module
- Funciones nuevas: `hasUnresolvedEvents()`, `hasUnresolvedSharedState()`, `hasLowConfidenceConnections()`

---

## Estadisticas

| Metrica | Valor |
|---------|-------|
| Archivos modificados | ~76 |
| Archivos nuevos | ~17 |
| Archivos eliminados | ~21 |
| Lineas eliminadas | -8,913 |
| Lineas agregadas | +1,709 |
| Reduccion neta | ~7,200 lineas |
| Nuevos extractores | 3 |
| Nuevos arquetipos | 3 |
| Arquetipos removidos | 2 |

---

## Test Cases

Nuevo escenario: `test-cases/scenario-new-extractors/` con 13 archivos cubriendo:
- Shared routes (server + client)
- Shared env variables
- Co-located files (test, stories)
- Nuevos arquetipos (facade, config-hub, entry-point)

---

## Breaking Changes

- **Carpeta de datos**: `.OmnySysData` → `.omnysysdata` (proyectos existentes necesitan renombrar la carpeta)
- **Arquetipos removidos**: `styled-component` y `type-definer` ya no se detectan
- **CLI**: `omnysystem` → `omnysys` en comandos

## Migracion

```bash
# Renombrar carpeta de datos en proyectos existentes
mv .OmnySysData .omnysysdata
# o en Windows
ren .OmnySysData .omnysysdata
```
